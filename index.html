</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camp Mataponi booking and payment</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <div class="form-header">
            <h1>Complete Your Payment</h1>
            <p>Please provide your information below to complete the payment.</p>
        </div>

        <form id="user-form">
            <div class="form-group">
                <label for="first-name">First Name</label>
                <input type="text" id="first-name" name="first-name">
                <div class="error-message" id="error-first-name" style="display: none;">*This is a required field.</div>
            </div>
            <div class="form-group">
                <label for="last-name">Last Name</label>
                <input type="text" id="last-name" name="last-name">
                <div class="error-message" id="error-last-name" style="display: none;">*This is a required field.</div>
            </div>

            <div class="form-group-checkbox">
                <input type="checkbox" id="plus-one-checkbox">
                <label for="plus-one-checkbox">Will you be bringing a plus one?</label>
            </div>

            <div id="guest-fields" style="display: none;">
                <div class="form-group">
                    <label for="guest-first-name">Guest First Name</label>
                    <input type="text" id="guest-first-name" name="guest-first-name">
                    <div class="error-message" id="error-guest-first-name" style="display: none;">*This is a required field.</div>
                </div>
                <div class="form-group">
                    <label for="guest-last-name">Guest Last Name</label>
                    <input type="text" id="guest-last-name" name="guest-last-name">
                    <div class="error-message" id="error-guest-last-name" style="display: none;">*This is a required field.</div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="nights-select">Nights</label>
                <select id="nights-select" name="nights-select">
                    <option value="" selected disabled>-- Select number of nights --</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                </select>
                <div class="error-message" id="error-nights" style="display: none;">*This is a required field.</div>
            </div>
        </form>

        <div class="payment-details">
            <h2>Order Summary</h2>
            <div class="price-item">
                <span id="summary-line-1">1 guest x $1.00/guest</span>
                <span class="price" id="subtotal-1">$0.00</span>
            </div>
            <div class="price-item">
                <span id="summary-line-2">0 Night(s)</span>
                <span class="price" id="subtotal-2">$0.00</span>
            </div>
            <div class="price-item">
                <span>Paypal processing fee</span>
                <span class="price" id="processing-fee">$0.00</span>
            </div>
            <hr>
            <div class="price-item total">
                <span>Total Amount:</span>
                <span class="price" id="total-amount">$0.00</span>
            </div>
        </div>
        
        <div class="error-message" id="error-general" style="display: none; text-align: center; margin-top: 15px;">
            Please complete all required fields.
        </div>

        <div id="paypal-button-container"></div>
    </div>

    <script src="https://www.paypal.com/sdk/js?client-id=AcKDEXRO_9HJQeZZFtq5OSIE6i4UdASf1QQb_D9c34AXsf9NZFZGGU4D3JpE3hZrD5lwgckCP5-t0A_y&currency=USD&enable-funding=venmo"></script>
    
    <script src="app.js"></script>

</body>
</html>





<div class="container">
    <div class="form-header">
        <h1>Complete Your Payment</h1>
        <p>Please provide your information below to complete the payment.</p>
    </div>

    <form id="user-form">
        <div class="form-group">
            <label for="first-name">First Name</label>
            <input type="text" id="first-name" name="first-name">
            <div class="error-message" id="error-first-name" style="display: none;">*This is a required field.</div>
        </div>
        <div class="form-group">
            <label for="last-name">Last Name</label>
            <input type="text" id="last-name" name="last-name">
            <div class="error-message" id="error-last-name" style="display: none;">*This is a required field.</div>
        </div>

        <div class="form-group-checkbox">
            <input type="checkbox" id="plus-one-checkbox">
            <label for="plus-one-checkbox">Will you be bringing a plus one?</label>
        </div>

        <div id="guest-fields" style="display: none;">
            <div class="form-group">
                <label for="guest-first-name">Guest First Name</label>
                <input type="text" id="guest-first-name" name="guest-first-name">
                <div class="error-message" id="error-guest-first-name" style="display: none;">*This is a required field.</div>
            </div>
            <div class="form-group">
                <label for="guest-last-name">Guest Last Name</label>
                <input type="text" id="guest-last-name" name="guest-last-name">
                <div class="error-message" id="error-guest-last-name" style="display: none;">*This is a required field.</div>
            </div>
        </div>
        
        <div class="form-group">
            <label for="nights-select">Nights</label>
            <select id="nights-select" name="nights-select">
                <option value="" selected disabled>-- Select number of nights --</option>
                <option value="1">1</option>
                <option value="2">2</option>
            </select>
            <div class="error-message" id="error-nights" style="display: none;">*This is a required field.</div>
        </div>
    </form>

    <div class="payment-details">
        <h2>Order Summary</h2>
        <div class="price-item">
            <span id="summary-line-1">1 guest x 1.00/guest</span>
            <span class="price" id="subtotal-1">$0.00</span>
        </div>
        <div class="price-item">
            <span id="summary-line-2">0 Nights</span>
            <span class="price" id="subtotal-2">$0.00</span>
        </div>
        <div class="price-item">
            <span>Processing fee</span>
            <span class="price" id="processing-fee">$0.00</span>
        </div>
        <hr>
        <div class="price-item total">
            <span>Total Amount:</span>
            <span class="price" id="total-amount">$0.00</span>
        </div>
    </div>
    
    <div class="error-message" id="error-general" style="display: none; text-align: center; margin-top: 15px;">
        Please complete all required fields.
    </div>

    <div id="paypal-button-container"></div>
</div>

<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        background-color: #f4f7f9;
        margin: 20px;
        color: #333;
    }
    .container {
        background-color: #c6ddbc;
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 480px;
        text-align: center;
        margin: auto;
    }
    .form-header h1 { margin: 0 0 10px; font-size: 28px; color: #1a202c; }
    .form-header p { margin: 0 0 30px; color: #343b46; font-size: 16px; }
    .form-group, .form-group-checkbox { margin-bottom: 20px; text-align: left; }
    .form-group-checkbox { display: flex; align-items: center; }
    .form-group-checkbox input { margin-right: 10px; width: 18px; height: 18px; }
    .form-group label, .form-group-checkbox label { display: block; font-weight: 600; color: #343b46; }
    .form-group input, .form-group select {
        width: 100%;
        padding: 12px;
        border: 1px solid #cbd5e0;
        border-radius: 8px;
        font-size: 16px;
        box-sizing: border-box;
    }
    .form-group input:focus, .form-group select:focus {
        outline: none;
        border-color: #4299e1;
        box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.5);
    }
    .payment-details {
        text-align: left;
        margin-top: 30px;
        padding: 20px;
        background-color: #f7fafc;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
    }
    .payment-details h2 { margin: 0 0 15px; font-size: 20px; color: #2d3748; }
    .price-item { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 16px; color: #4a5568; }
    .price-item.total { font-weight: bold; font-size: 18px; color: #1a202c; }
    .price { font-weight: 600; }
    hr { border: none; border-top: 1px solid #e2e8f0; margin: 15px 0; }
    #paypal-button-container { margin-top: 30px; }
    .error-message { color: #e53e3e; font-size: 14px; font-weight: 500; margin-top: 4px; }
</style>

<script src="https://www.paypal.com/sdk/js?client-id=YOUR_CLIENT_ID&currency=USD&enable-funding=venmo&disable-funding=credit,card"></script>

<script>
    // --- FORM ELEMENTS ---
    const plusOneCheckbox = document.getElementById('plus-one-checkbox');
    const guestFields = document.getElementById('guest-fields');
    const nightsSelect = document.getElementById('nights-select');
    
    const firstNameInput = document.getElementById('first-name');
    const lastNameInput = document.getElementById('last-name');
    const guestFirstNameInput = document.getElementById('guest-first-name');
    const guestLastNameInput = document.getElementById('guest-last-name');

    // --- SUMMARY ELEMENTS ---
    const summaryLine1 = document.getElementById('summary-line-1');
    const subtotal1 = document.getElementById('subtotal-1');
    const summaryLine2 = document.getElementById('summary-line-2');
    const subtotal2 = document.getElementById('subtotal-2');
    const processingFeeEl = document.getElementById('processing-fee');
    const totalAmountEl = document.getElementById('total-amount');

    // --- ERROR MESSAGE ELEMENTS ---
    const generalError = document.getElementById('error-general');
    const errorMessages = {
        firstName: document.getElementById('error-first-name'),
        lastName: document.getElementById('error-last-name'),
        guestFirstName: document.getElementById('error-guest-first-name'),
        guestLastName: document.getElementById('error-guest-last-name'),
        nights: document.getElementById('error-nights'),
    };
    
    let finalAmount = '0.00'; // To store the total for PayPal

    // --- MAIN FUNCTION TO UPDATE EVERYTHING ---
    function updateOrderAndValidate() {
        // 1. Get current values
        const isPlusOne = plusOneCheckbox.checked;
        const nights = parseInt(nightsSelect.value) || 0;
        
        // Show/hide guest fields
        guestFields.style.display = isPlusOne ? 'block' : 'none';

        // 2. Calculations
        const numGuests = isPlusOne ? 2 : 1;
        const costPerNight = numGuests * 1.00;
        const basePrice = costPerNight * nights;
        const processingFee = basePrice > 0 ? (basePrice * 0.0349 + 0.45) : 0;
        const total = basePrice + processingFee;
        finalAmount = total.toFixed(2);
        
        // 3. Update Order Summary text
        summaryLine1.textContent = `${numGuests} guest${numGuests > 1 ? 's' : ''} x $1.00/guest`;
        subtotal1.textContent = `$${costPerNight.toFixed(2)}`;
        summaryLine2.textContent = `x ${nights} Night${nights !== 1 ? 's' : ''}`;
        subtotal2.textContent = `$${basePrice.toFixed(2)}`;
        processingFeeEl.textContent = `$${processingFee.toFixed(2)}`;
        totalAmountEl.textContent = `$${finalAmount}`;

        // 4. Validation
        let isValid = true;
        const hideError = (el) => { el.style.display = 'none'; };
        const showError = (el) => { el.style.display = 'block'; isValid = false; };
        
        // Hide all errors to start
        Object.values(errorMessages).forEach(hideError);
        hideError(generalError);

        if (!firstNameInput.value) showError(errorMessages.firstName);
        if (!lastNameInput.value) showError(errorMessages.lastName);
        if (!nightsSelect.value) showError(errorMessages.nights);
        
        if (isPlusOne) {
            if (!guestFirstNameInput.value) showError(errorMessages.guestFirstName);
            if (!guestLastNameInput.value) showError(errorMessages.guestLastName);
        }
        
        if (!isValid) {
            showError(generalError);
        }
        
        return isValid;
    }

    // --- PAYPAL BUTTONS LOGIC ---
    const paypalButtons = paypal.Buttons({
        // Called when page loads
        onInit: function(data, actions) {
            actions.disable(); // Disable buttons by default
            
            // Listen for changes on all relevant fields
            document.querySelectorAll('#user-form input, #user-form select').forEach(el => {
                el.addEventListener('change', () => {
                    const isValid = updateOrderAndValidate();
                    if (isValid) {
                        actions.enable();
                    } else {
                        actions.disable();
                    }
                });
            });
        },
        // Called when button is clicked
        onClick: function(data, actions) {
            const isFormValid = updateOrderAndValidate();
            if (!isFormValid) {
                return actions.reject(); // Prevents PayPal pop-up
            }
            return actions.resolve();
        },
        // Setup the transaction
        createOrder: function(data, actions) {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: finalAmount, // Use the dynamically calculated total
                        currency_code: 'USD'
                    }
                }]
            });
        },
        // Finalize the transaction
        onApprove: function(data, actions) {
            return actions.order.capture().then(function(details) {
                // Hide form and show success message on completion
                document.querySelector('.container').innerHTML = `
                    <div class="form-header">
                        <h2>Thank you for your payment!</h2>
                        <p>Your transaction has been completed successfully.</p>
                        <p>A confirmation has been sent to ${details.payer.email_address}.</p>
                    </div>`;
            });
        },
        onError: function(err) {
            console.error('An error occurred with the PayPal button:', err);
        }
    });
    
    // Render the PayPal buttons if the container exists
    if (document.getElementById('paypal-button-container')) {
        paypalButtons.render('#paypal-button-container');
    }

    // Initial call to set the summary on page load
    updateOrderAndValidate();
</script>